--###########################################################################--###########################################################################--############################AUTO_FSTA_POINT################################--###########################################################################--###########################################################################--###########################Three steps:--####################1.Insert point for FDIR--####################  Device from gis_breaker,choosen station's switch--####################2.Reorder points --####################3.Insert Control point--####################--#####################Rely table:----							-	DAS_FAKESTATIONNUM--			--#####################--#####################Created by/Updated by: GL/CL--###########################################################################--###########################################################################--####################			     Caution!			    #################--####################Please make sure the source of devices#################--####################			are what you want!		    #################--####################									    #################--###########################################################################--###########################################################################--AUTO_FSTA process/*--drop table Das_FakestationNUM;--create table Das_FakestationNUM (stationnum VARCHAR2(10) not null );--insert into Das_Fakestationnum (stationnum) values (2000);*/drop table das_rtdb_fakestation ;create table das_rtdb_fakestation as select * from das_rtdb where equip_num ='EMPTY_DAS_RTDB';--###########################################################################--###########################################################################--###########################################################################--##	STATUS Points: STASTATUS, LOCREMFLAG, FAULTFLAG, RECLLOCKFLAG--################FOR     GIS_BREAKER,Choosen STATION's switch###############--###########################################################################--###########################################################################insert into das_rtdb_fakestation select 'SWITCH', a.name, 'STASTATUS',    0,1,1, b.stationnum, 'P', rownum, 'CS', 'STASTATUS','SWITCH '||a.name||' STASTATUS', null from gis_breaker a, das_fakestationnum b;insert into das_rtdb_fakestation select 'SWITCH', a.name, 'LOCREMFLAG',   0,1,1, b.stationnum, 'P', rownum, 'CS', 'LOCREMFLAG','SWITCH '||a.name||' LOCREMFLAG', null from gis_breaker a, das_fakestationnum b;insert into das_rtdb_fakestation select 'SWITCH', a.name, 'FAULTFLAG',    0,1,1, b.stationnum, 'P', rownum, 'CS', 'FAULTFLAG','SWITCH '||a.name||' FAULTFLAG', null from gis_breaker a, das_fakestationnum b;insert into das_rtdb_fakestation select 'SWITCH', a.name, 'RECLLOCKFLAG', 0,1,1, b.stationnum, 'P', rownum, 'CS', 'RECLLOCKFLAG','SWITCH '||a.name||' RECLLOCKFLAG', null from gis_breaker a, das_fakestationnum b;insert into das_rtdb_fakestation select 'SWITCH', a.name, 'STASTATUS',    0,1,1, b.stationnum, 'P', rownum, 'CS', 'STASTATUS','SWITCH '||a.name||' STASTATUS', null from breaker a, das_fakestationnum b;insert into das_rtdb_fakestation select 'SWITCH', a.name, 'LOCREMFLAG',   0,1,1, b.stationnum, 'P', rownum, 'CS', 'LOCREMFLAG','SWITCH '||a.name||' LOCREMFLAG', null from breaker a, das_fakestationnum b;insert into das_rtdb_fakestation select 'SWITCH', a.name, 'FAULTFLAG',    0,1,1, b.stationnum, 'P', rownum, 'CS', 'FAULTFLAG','SWITCH '||a.name||' FAULTFLAG', null from breaker a, das_fakestationnum b;insert into das_rtdb_fakestation select 'SWITCH', a.name, 'RECLLOCKFLAG', 0,1,1, b.stationnum, 'P', rownum, 'CS', 'RECLLOCKFLAG','SWITCH '||a.name||' RECLLOCKFLAG', null from breaker a, das_fakestationnum b;insert into das_rtdb_fakestation select 'FEEDER', a.name, 'FDIRLOCKFLAG', 0,1,1, b.stationnum2, 'P', rownum, 'CS', 'FDIRLOCKFLAG','SWITCH '||a.name||' FDIRLOCKFLAG', null from feeder a, das_fakestationnum b where fdtype=0;insert into das_rtdb_fakestation select 'FEEDER', a.name, 'FDIRLOCKFLAG', 0,1,1, b.stationnum2, 'P', rownum, 'CS', 'FDIRLOCKFLAG','SWITCH '||a.name||' FDIRLOCKFLAG', null from gis_feeder a, das_fakestationnum b where fdtype=0;--#################of switch##############commit;insert into das_rtdb_fakestation select 'SWITCH', a.name, 'STASTATUS',    0,1,1, b.stationnum, 'P', rownum, 'CS', 'STASTATUS','SWITCH '||a.name||' STASTATUS', null from gis_switch a, das_fakestationnum b where a.substation=(select name from gis_substation where ufid=(select teststationufid1 from das_fakestationnum)) and a.SWTYPE not like 'F%';insert into das_rtdb_fakestation select 'SWITCH', a.name, 'LOCREMFLAG',   0,1,1, b.stationnum, 'P', rownum, 'CS', 'LOCREMFLAG','SWITCH '||a.name||' LOCREMFLAG', null from gis_switch a, das_fakestationnum b where a.substation=(select name from gis_substation where ufid=(select teststationufid1 from das_fakestationnum)) and a.SWTYPE not like 'F%';insert into das_rtdb_fakestation select 'SWITCH', a.name, 'FAULTFLAG',    0,1,1, b.stationnum, 'P', rownum, 'CS', 'FAULTFLAG','SWITCH '||a.name||' FAULTFLAG', null from gis_switch a, das_fakestationnum b where a.substation=(select name from gis_substation where ufid=(select teststationufid1 from das_fakestationnum)) and a.SWTYPE not like 'F%';--insert into das_rtdb_fakestation select 'SWITCH', a.name, 'RECLLOCKFLAG', 0,1,1, b.stationnum, 'P', rownum, 'CS', 'RECLLOCKFLAG','SWITCH '||a.name||' RECLLOCKFLAG', null from gis_switch a, das_fakestationnum b where a.substation=(select name from gis_substation where ufid=(select teststationufid1 from das_fakestationnum)) and a.SWTYPE not like 'F%';commit;insert into das_rtdb_fakestation select 'SWITCH', a.name, 'STASTATUS',    0,1,1, b.stationnum, 'P', rownum, 'CS', 'STASTATUS','SWITCH '||a.name||' STASTATUS', null from gis_switch a, das_fakestationnum b where a.substation=(select name from gis_substation where ufid=(select teststationufid2 from das_fakestationnum)) and a.SWTYPE not like 'F%';insert into das_rtdb_fakestation select 'SWITCH', a.name, 'LOCREMFLAG',   0,1,1, b.stationnum, 'P', rownum, 'CS', 'LOCREMFLAG','SWITCH '||a.name||' LOCREMFLAG', null from gis_switch a, das_fakestationnum b where a.substation=(select name from gis_substation where ufid=(select teststationufid2 from das_fakestationnum)) and a.SWTYPE not like 'F%';insert into das_rtdb_fakestation select 'SWITCH', a.name, 'FAULTFLAG',    0,1,1, b.stationnum, 'P', rownum, 'CS', 'FAULTFLAG','SWITCH '||a.name||' FAULTFLAG', null from gis_switch a, das_fakestationnum b where a.substation=(select name from gis_substation where ufid=(select teststationufid2 from das_fakestationnum)) and a.SWTYPE not like 'F%';--insert into das_rtdb_fakestation select 'SWITCH', a.name, 'RECLLOCKFLAG', 0,1,1, b.stationnum, 'P', rownum, 'CS', 'RECLLOCKFLAG','SWITCH '||a.name||' RECLLOCKFLAG', null from gis_switch a, das_fakestationnum b where a.substation=(select name from gis_substation where ufid=(select teststationufid2 from das_fakestationnum)) and a.SWTYPE not like 'F%';commit;--#################of Optional switch##############insert into das_rtdb_fakestation select 'SWITCH', a.name, 'STASTATUS',    0,1,1, b.stationnum3, 'P', rownum, 'CS', 'STASTATUS','SWITCH '||a.name||' STASTATUS', null from gis_switch a, das_fakestationnum b where a.name in(select equip_num from DAS_RTDB_FSTA_OPTIONAL_DEVICES) and a.SWTYPE not like 'F%';insert into das_rtdb_fakestation select 'SWITCH', a.name, 'LOCREMFLAG',   0,1,1, b.stationnum3, 'P', rownum, 'CS', 'LOCREMFLAG','SWITCH '||a.name||' LOCREMFLAG', null from gis_switch a, das_fakestationnum b where a.name in(select equip_num from DAS_RTDB_FSTA_OPTIONAL_DEVICES) and a.SWTYPE not like 'F%';insert into das_rtdb_fakestation select 'SWITCH', a.name, 'FAULTFLAG',    0,1,1, b.stationnum3, 'P', rownum, 'CS', 'FAULTFLAG','SWITCH '||a.name||' FAULTFLAG', null from gis_switch a, das_fakestationnum b where a.name in(select equip_num from DAS_RTDB_FSTA_OPTIONAL_DEVICES) and a.SWTYPE not like 'F%';--insert into das_rtdb_fakestation select 'SWITCH', a.name, 'RECLLOCKFLAG', 0,1,1, b.stationnum3, 'P', rownum, 'CS', 'RECLLOCKFLAG','SWITCH '||a.name||' RECLLOCKFLAG', null from gis_switch a, das_fakestationnum b where a.name in(select equip_num from DAS_RTDB_FSTA_OPTIONAL_DEVICES) and a.SWTYPE not like 'F%';commit;--#################of gis_cap##############insert into das_rtdb_fakestation select 'CAPACITOR', a.name, 'STASTATUS',    0,1,1, b.stationnum, 'P', rownum, 'CS', 'STASTATUS','CAPACITOR '||a.name||' STASTATUS', null from gis_capacitor a, das_fakestationnum b;insert into das_rtdb_fakestation select 'CAPACITOR', a.name, 'LOCREMFLAG',   0,1,1, b.stationnum, 'P', rownum, 'CS', 'LOCREMFLAG','CAPACITOR '||a.name||' LOCREMFLAG', null from gis_capacitor a, das_fakestationnum b;--#################of gis_Regulator##############insert into das_rtdb_fakestation select 'TRANSFORMER', a.name, 'LOCREMFLAG', 0,1,1, b.stationnum, 'P', rownum, 'CS', 'LOCREMFLAG','TRANSFORMER '||a.name||' LOCREMFLAG', null from gis_maintransformer a, das_fakestationnum b;insert into das_rtdb_fakestation select 'TRANSFORMER', a.name, 'LTCLOCK',    0,1,1, b.stationnum, 'P', rownum, 'CS', 'LTCLOCK','TRANSFORMER '||a.name||' LTCLOCK', null from gis_maintransformer a, das_fakestationnum b;insert into das_rtdb_fakestation select 'TRANSFORMER', a.name, 'LOCLTCLOCK', 0,1,1, b.stationnum, 'P', rownum, 'CS', 'LOCLTCLOCK','TRANSFORMER '||a.name||' LOCLTCLOCK', null from gis_maintransformer a, das_fakestationnum b;insert into das_rtdb_fakestation select 'TRANSFORMER', a.name, 'VCLOCKFLAG', 0,1,1, b.stationnum2, 'P', rownum, 'CS', 'VCLOCKFLAG','TRANSFORMER '||a.name||' VCLOCKFLAG', null from gis_maintransformer a, das_fakestationnum b;--###########################################################################--################################ReOrder Rownum for redundancy #############--20170306CL For the FDIR display.Deploy FAULTFLAG order by EQUIP_NUM --create table FSTA_TMP_FOR_FAULTFLAG as select * from das_rtdb_fakestation where colname='FAULTFLAG' order by equip_num;--update FSTA_TMP_FOR_FAULTFLAG set point=rownum;--update das_rtdb_fakestation a set point=(select point from FSTA_TMP_FOR_FAULTFLAG where a.equip_num=equip_num) where equip_num in (select equip_num from das_rtdb_fakestation where colname='FAULTFLAG')--commit;--drop table FSTA_TMP_FOR_FAULTFLAG;--update das_rtdb_fakestation set point=rownum where colname='STASTATUS' and tablename='SWITCH' and station=(select stationnum from das_fakestationnum);update das_rtdb_fakestation set point=rownum where colname='LOCREMFLAG' and tablename='SWITCH' and station=(select stationnum from das_fakestationnum);--update das_rtdb_fakestation set point=rownum where colname='FAULTFLAG' and tablename='SWITCH' and station=(select stationnum from das_fakestationnum);--update das_rtdb_fakestation set point=rownum where colname='RECLLOCKFLAG' and tablename='SWITCH' and station=(select stationnum from das_fakestationnum);--#####ReOrder Rownum for redundancy_optional#############update das_rtdb_fakestation set point=rownum where colname='STASTATUS' and tablename='SWITCH' and station=(select stationnum3 from das_fakestationnum);update das_rtdb_fakestation set point=rownum where colname='LOCREMFLAG' and tablename='SWITCH' and station=(select stationnum3 from das_fakestationnum);update das_rtdb_fakestation set point=rownum where colname='FAULTFLAG' and tablename='SWITCH' and station=(select stationnum3 from das_fakestationnum);--update das_rtdb_fakestation set point=rownum where colname='RECLLOCKFLAG' and tablename='SWITCH' and station=(select stationnum3 from das_fakestationnum);--update das_rtdb_fakestation set point=rownum where colname='FDIRLOCKFLAG' and tablename='FEEDER';--20170306CL For the FDIR display.Deploy FAULTFLAG order by EQUIP_NUM update das_rtdb_fakestation set point=point+(select max(color) from VIEW_FEEDER_ALL ) where colname='VCLOCKFLAG' and tablename='TRANSFORMER';update das_rtdb_fakestation a set point=(select color from VIEW_FEEDER_ALL where name=a.equip_num) where colname='FDIRLOCKFLAG' and tablename='FEEDER' and station=(select stationnum2 from das_fakestationnum);--update das_rtdb_fakestation set point=rownum where station=(select stationnum2 from das_fakestationnum);--###########################################################################--################################Comb the point ############################/*--update das_rtdb_fakestation a set point = (select point+1000*1 from das_rtdb_fakestation where a.tablename||'x'||a.equip_num||'x'||'STASTATUS'=tablename||'x'||equip_num||'x'||colname)  where tablename in ('SWITCH') and colname='LOCREMFLAG' and equip_num in (select equip_num from das_rtdb_fakestation where tablename='SWITCH' and colname='STASTATUS');*/update das_rtdb_fakestation a set point = (select point+1*ceil((select max(point) from das_rtdb_fakestation where colname='LOCREMFLAG' and attribute='CS')/1000)*1000 from das_rtdb_fakestation where a.tablename||'x'||a.equip_num||'x'||'LOCREMFLAG'=tablename||'x'||equip_num||'x'||colname)  where tablename in ('SWITCH') and colname='LOCREMFLAG' and equip_num in (select equip_num from das_rtdb_fakestation where tablename='SWITCH' and colname='LOCREMFLAG');update das_rtdb_fakestation a set point = (select point+2*ceil((select max(point) from das_rtdb_fakestation where colname='FAULTFLAG' and attribute='CS')/1000)*1000 from das_rtdb_fakestation where a.tablename||'x'||a.equip_num||'x'||'FAULTFLAG'=tablename||'x'||equip_num||'x'||colname)  where tablename in ('SWITCH') and colname='FAULTFLAG' and equip_num in (select equip_num from das_rtdb_fakestation where tablename='SWITCH' and colname='FAULTFLAG');update das_rtdb_fakestation a set point = (select point+3*ceil((select max(point) from das_rtdb_fakestation where colname='RECLLOCKFLAG' and attribute='CS')/1000)*1000 from das_rtdb_fakestation where a.tablename||'x'||a.equip_num||'x'||'RECLLOCKFLAG'=tablename||'x'||equip_num||'x'||colname)  where tablename in ('SWITCH') and colname='RECLLOCKFLAG' and equip_num in (select equip_num from das_rtdb_fakestation where tablename='SWITCH' and colname='RECLLOCKFLAG'); --update das_rtdb_fakestation a set point = (select point+4*ceil((select max(point) from das_rtdb_fakestation where colname='FDIRLOCKFLAG' and attribute='CS')/1000)*1000 from das_rtdb_fakestation where a.tablename||'x'||a.equip_num||'x'||'FDIRLOCKFLAG'=tablename||'x'||equip_num||'x'||colname) -- where tablename in ('FEEDER') and colname='FDIRLOCKFLAG' and equip_num in (select equip_num from das_rtdb_fakestation where tablename='FEEDER' and colname='FDIRLOCKFLAG');update das_rtdb_fakestation a set point = (select point+4*ceil((select max(point) from das_rtdb_fakestation where colname='STASTATUS' and tablename='CAPACITOR' and attribute='CS')/1000)*1000 from das_rtdb_fakestation where a.tablename||'x'||a.equip_num||'x'||'STASTATUS'=tablename||'x'||equip_num||'x'||colname)  where tablename in ('CAPACITOR') and colname='STASTATUS' and equip_num in (select equip_num from das_rtdb_fakestation where tablename='CAPACITOR' and colname='STASTATUS');update das_rtdb_fakestation a set point = (select point+5*ceil((select max(point) from das_rtdb_fakestation where colname='LOCREMFLAG' and tablename='CAPACITOR' and attribute='CS')/1000)*1000 from das_rtdb_fakestation where a.tablename||'x'||a.equip_num||'x'||'LOCREMFLAG'=tablename||'x'||equip_num||'x'||colname)  where tablename in ('CAPACITOR') and colname='LOCREMFLAG' and equip_num in (select equip_num from das_rtdb_fakestation where tablename='CAPACITOR' and colname='LOCREMFLAG');update das_rtdb_fakestation a set point = (select point+6*ceil((select max(point) from das_rtdb_fakestation where colname='LOCREMFLAG' and tablename='TRANSFORMER' and attribute='CS')/1000)*1000 from das_rtdb_fakestation where a.tablename||'x'||a.equip_num||'x'||'LOCREMFLAG'=tablename||'x'||equip_num||'x'||colname)  where tablename in ('TRANSFORMER') and colname='LOCREMFLAG' and equip_num in (select equip_num from das_rtdb_fakestation where tablename='TRANSFORMER' and colname='LOCREMFLAG');update das_rtdb_fakestation a set point = (select point+7*ceil((select max(point) from das_rtdb_fakestation where colname='LTCLOCK' and tablename='TRANSFORMER' and attribute='CS')/1000)*1000 from das_rtdb_fakestation where a.tablename||'x'||a.equip_num||'x'||'LTCLOCK'=tablename||'x'||equip_num||'x'||colname)  where tablename in ('TRANSFORMER') and colname='LTCLOCK' and equip_num in (select equip_num from das_rtdb_fakestation where tablename='TRANSFORMER' and colname='LTCLOCK');update das_rtdb_fakestation a set point = (select point+8*ceil((select max(point) from das_rtdb_fakestation where colname='LOCLTCLOCK' and tablename='TRANSFORMER' and attribute='CS')/1000)*1000 from das_rtdb_fakestation where a.tablename||'x'||a.equip_num||'x'||'LOCLTCLOCK'=tablename||'x'||equip_num||'x'||colname)  where tablename in ('TRANSFORMER') and colname='LOCLTCLOCK' and equip_num in (select equip_num from das_rtdb_fakestation where tablename='TRANSFORMER' and colname='LOCLTCLOCK');commit;--###########################################################################--###########################################################################--###########################################################################--##	TELEMETRY Points: PA/PB/PC, QA/QB/QC, AMPA/QMPB/QMPC, VA/VB/VC--################FOR     GIS_BREAKER,Choosen STATION's switch###############--###########################################################################--###########################################################################--delete das_rtdb_fakestation where attribute='CV' and station=600 and category='R';--##		Define the point count per switch: 10 or 20insert into das_rtdb_fakestation select 'SWITCH', a.name, 'PA',   0,1,2, b.stationnum, 'P', rownum, 'CV', 'KW', a.name||' PA', null from gis_breaker a, das_fakestationnum b;insert into das_rtdb_fakestation select 'SWITCH', a.name, 'PB',   0,1,2, b.stationnum, 'P', rownum, 'CV', 'KW', a.name||' PB', null from gis_breaker a, das_fakestationnum b;insert into das_rtdb_fakestation select 'SWITCH', a.name, 'PC',   0,1,2, b.stationnum, 'P', rownum, 'CV', 'KW', a.name||' PC', null from gis_breaker a, das_fakestationnum b;insert into das_rtdb_fakestation select 'SWITCH', a.name, 'QA',   0,1,2, b.stationnum, 'P', rownum, 'CV', 'KVAR', a.name||' QA', null from gis_breaker a, das_fakestationnum b;insert into das_rtdb_fakestation select 'SWITCH', a.name, 'QB',   0,1,2, b.stationnum, 'P', rownum, 'CV', 'KVAR', a.name||' QB', null from gis_breaker a, das_fakestationnum b;insert into das_rtdb_fakestation select 'SWITCH', a.name, 'QC',   0,1,2, b.stationnum, 'P', rownum, 'CV', 'KVAR', a.name||' QC', null from gis_breaker a, das_fakestationnum b;insert into das_rtdb_fakestation select 'SWITCH', a.name, 'AMPA',   0,1,2, b.stationnum, 'P', rownum, 'CV', 'AMP', a.name||' AMPA', null from gis_breaker a, das_fakestationnum b;insert into das_rtdb_fakestation select 'SWITCH', a.name, 'AMPB',   0,1,2, b.stationnum, 'P', rownum, 'CV', 'AMP', a.name||' AMPB', null from gis_breaker a, das_fakestationnum b;insert into das_rtdb_fakestation select 'SWITCH', a.name, 'AMPC',   0,1,2, b.stationnum, 'P', rownum, 'CV', 'AMP', a.name||' AMPC', null from gis_breaker a, das_fakestationnum b;--/*insert into das_rtdb_fakestation select 'SWITCH', a.name, 'VOLTMAGA',   0,1,2, b.stationnum, 'P', rownum, 'CV', 'KV', a.name||' VOLTMAGA', null from gis_breaker a, das_fakestationnum b;insert into das_rtdb_fakestation select 'SWITCH', a.name, 'VOLTMAGB',   0,1,2, b.stationnum, 'P', rownum, 'CV', 'KV', a.name||' VOLTMAGB', null from gis_breaker a, das_fakestationnum b;insert into das_rtdb_fakestation select 'SWITCH', a.name, 'VOLTMAGC',   0,1,2, b.stationnum, 'P', rownum, 'CV', 'KV', a.name||' VOLTMAGC', null from gis_breaker a, das_fakestationnum b;--*/commit;insert into das_rtdb_fakestation select 'SWITCH', a.name, 'PA',   0,1,2, b.stationnum, 'P', rownum, 'CV', 'KW',  a.name||' PA', null from breaker a, das_fakestationnum b;insert into das_rtdb_fakestation select 'SWITCH', a.name, 'PB',   0,1,2, b.stationnum, 'P', rownum, 'CV', 'KW', a.name||' PB', null from breaker a, das_fakestationnum b;insert into das_rtdb_fakestation select 'SWITCH', a.name, 'PC',   0,1,2, b.stationnum, 'P', rownum, 'CV', 'KW', a.name||' PC', null from breaker a, das_fakestationnum b;insert into das_rtdb_fakestation select 'SWITCH', a.name, 'QA',   0,1,2, b.stationnum, 'P', rownum, 'CV', 'KVAR', a.name||' QA', null from breaker a, das_fakestationnum b;insert into das_rtdb_fakestation select 'SWITCH', a.name, 'QB',   0,1,2, b.stationnum, 'P', rownum, 'CV', 'KVAR', a.name||' QB', null from breaker a, das_fakestationnum b;insert into das_rtdb_fakestation select 'SWITCH', a.name, 'QC',   0,1,2, b.stationnum, 'P', rownum, 'CV', 'KVAR', a.name||' QC', null from breaker a, das_fakestationnum b;insert into das_rtdb_fakestation select 'SWITCH', a.name, 'AMPA',   0,1,2, b.stationnum, 'P', rownum, 'CV', 'AMP', a.name||' AMPA', null from breaker a, das_fakestationnum b;insert into das_rtdb_fakestation select 'SWITCH', a.name, 'AMPB',   0,1,2, b.stationnum, 'P', rownum, 'CV', 'AMP', a.name||' AMPB', null from breaker a, das_fakestationnum b;insert into das_rtdb_fakestation select 'SWITCH', a.name, 'AMPC',   0,1,2, b.stationnum, 'P', rownum, 'CV', 'AMP', a.name||' AMPC', null from breaker a, das_fakestationnum b;--/*insert into das_rtdb_fakestation select 'SWITCH', a.name, 'VOLTMAGA',   0,1,2, b.stationnum, 'P', rownum, 'CV', 'KV', a.name||' VOLTMAGA', null from breaker a, das_fakestationnum b;insert into das_rtdb_fakestation select 'SWITCH', a.name, 'VOLTMAGB',   0,1,2, b.stationnum, 'P', rownum, 'CV', 'KV', a.name||' VOLTMAGB', null from breaker a, das_fakestationnum b;insert into das_rtdb_fakestation select 'SWITCH', a.name, 'VOLTMAGC',   0,1,2, b.stationnum, 'P', rownum, 'CV', 'KV', a.name||' VOLTMAGC', null from breaker a, das_fakestationnum b;--*/commit;-------------of switchinsert into das_rtdb_fakestation select 'SWITCH', a.name, 'PA',   0,1,2, b.stationnum, 'P', rownum, 'CV', 'KW', a.name||' PA', null from gis_switch a, das_fakestationnum b where a.substation=(select name from gis_substation where ufid=(select teststationufid1 from das_fakestationnum)) and a.SWTYPE not like 'F%';insert into das_rtdb_fakestation select 'SWITCH', a.name, 'PB',   0,1,2, b.stationnum, 'P', rownum, 'CV', 'KW', a.name||' PB', null from gis_switch a, das_fakestationnum b where a.substation=(select name from gis_substation where ufid=(select teststationufid1 from das_fakestationnum)) and a.SWTYPE not like 'F%';insert into das_rtdb_fakestation select 'SWITCH', a.name, 'PC',   0,1,2, b.stationnum, 'P', rownum, 'CV', 'KW', a.name||' PC', null from gis_switch a, das_fakestationnum b where a.substation=(select name from gis_substation where ufid=(select teststationufid1 from das_fakestationnum)) and a.SWTYPE not like 'F%';insert into das_rtdb_fakestation select 'SWITCH', a.name, 'QA',   0,1,2, b.stationnum, 'P', rownum, 'CV', 'KVAR', a.name||' QA', null from gis_switch a, das_fakestationnum b where a.substation=(select name from gis_substation where ufid=(select teststationufid1 from das_fakestationnum)) and a.SWTYPE not like 'F%';insert into das_rtdb_fakestation select 'SWITCH', a.name, 'QB',   0,1,2, b.stationnum, 'P', rownum, 'CV', 'KVAR', a.name||' QB', null from gis_switch a, das_fakestationnum b where a.substation=(select name from gis_substation where ufid=(select teststationufid1 from das_fakestationnum)) and a.SWTYPE not like 'F%';insert into das_rtdb_fakestation select 'SWITCH', a.name, 'QC',   0,1,2, b.stationnum, 'P', rownum, 'CV', 'KVAR', a.name||' QC', null from gis_switch a, das_fakestationnum b where a.substation=(select name from gis_substation where ufid=(select teststationufid1 from das_fakestationnum)) and a.SWTYPE not like 'F%';insert into das_rtdb_fakestation select 'SWITCH', a.name, 'AMPA',   0,1,2, b.stationnum, 'P', rownum, 'CV', 'AMP', a.name||' AMPA', null from gis_switch a, das_fakestationnum b where a.substation=(select name from gis_substation where ufid=(select teststationufid1 from das_fakestationnum)) and a.SWTYPE not like 'F%';insert into das_rtdb_fakestation select 'SWITCH', a.name, 'AMPB',   0,1,2, b.stationnum, 'P', rownum, 'CV', 'AMP', a.name||' AMPB', null from gis_switch a, das_fakestationnum b where a.substation=(select name from gis_substation where ufid=(select teststationufid1 from das_fakestationnum)) and a.SWTYPE not like 'F%';insert into das_rtdb_fakestation select 'SWITCH', a.name, 'AMPC',   0,1,2, b.stationnum, 'P', rownum, 'CV', 'AMP', a.name||' AMPC', null from gis_switch a, das_fakestationnum b where a.substation=(select name from gis_substation where ufid=(select teststationufid1 from das_fakestationnum)) and a.SWTYPE not like 'F%';--/*insert into das_rtdb_fakestation select 'SWITCH', a.name, 'VOLTMAGA',   0,1,2, b.stationnum, 'P', rownum, 'CV', 'KV', a.name||' VOLTMAGA', null from gis_switch a, das_fakestationnum b where a.substation=(select name from gis_substation where ufid=(select teststationufid1 from das_fakestationnum)) and a.SWTYPE not like 'F%';insert into das_rtdb_fakestation select 'SWITCH', a.name, 'VOLTMAGB',   0,1,2, b.stationnum, 'P', rownum, 'CV', 'KV', a.name||' VOLTMAGB', null from gis_switch a, das_fakestationnum b where a.substation=(select name from gis_substation where ufid=(select teststationufid1 from das_fakestationnum)) and a.SWTYPE not like 'F%';insert into das_rtdb_fakestation select 'SWITCH', a.name, 'VOLTMAGC',   0,1,2, b.stationnum, 'P', rownum, 'CV', 'KV', a.name||' VOLTMAGC', null from gis_switch a, das_fakestationnum b where a.substation=(select name from gis_substation where ufid=(select teststationufid1 from das_fakestationnum)) and a.SWTYPE not like 'F%';--*/commit;insert into das_rtdb_fakestation select 'SWITCH', a.name, 'PA',   0,1,2, b.stationnum, 'P', rownum, 'CV', 'KW', a.name||' PA', null from gis_switch a, das_fakestationnum b where a.substation=(select name from gis_substation where ufid=(select teststationufid2 from das_fakestationnum)) and a.SWTYPE not like 'F%';insert into das_rtdb_fakestation select 'SWITCH', a.name, 'PB',   0,1,2, b.stationnum, 'P', rownum, 'CV', 'KW', a.name||' PB', null from gis_switch a, das_fakestationnum b where a.substation=(select name from gis_substation where ufid=(select teststationufid2 from das_fakestationnum)) and a.SWTYPE not like 'F%';insert into das_rtdb_fakestation select 'SWITCH', a.name, 'PC',   0,1,2, b.stationnum, 'P', rownum, 'CV', 'KW', a.name||' PC', null from gis_switch a, das_fakestationnum b where a.substation=(select name from gis_substation where ufid=(select teststationufid2 from das_fakestationnum)) and a.SWTYPE not like 'F%';insert into das_rtdb_fakestation select 'SWITCH', a.name, 'QA',   0,1,2, b.stationnum, 'P', rownum, 'CV', 'KVAR', a.name||' QA', null from gis_switch a, das_fakestationnum b where a.substation=(select name from gis_substation where ufid=(select teststationufid2 from das_fakestationnum)) and a.SWTYPE not like 'F%';insert into das_rtdb_fakestation select 'SWITCH', a.name, 'QB',   0,1,2, b.stationnum, 'P', rownum, 'CV', 'KVAR', a.name||' QB', null from gis_switch a, das_fakestationnum b where a.substation=(select name from gis_substation where ufid=(select teststationufid2 from das_fakestationnum)) and a.SWTYPE not like 'F%';insert into das_rtdb_fakestation select 'SWITCH', a.name, 'QC',   0,1,2, b.stationnum, 'P', rownum, 'CV', 'KVAR', a.name||' QC', null from gis_switch a, das_fakestationnum b where a.substation=(select name from gis_substation where ufid=(select teststationufid2 from das_fakestationnum)) and a.SWTYPE not like 'F%';insert into das_rtdb_fakestation select 'SWITCH', a.name, 'AMPA',   0,1,2, b.stationnum, 'P', rownum, 'CV', 'AMP', a.name||' AMPA', null from gis_switch a, das_fakestationnum b where a.substation=(select name from gis_substation where ufid=(select teststationufid2 from das_fakestationnum)) and a.SWTYPE not like 'F%';insert into das_rtdb_fakestation select 'SWITCH', a.name, 'AMPB',   0,1,2, b.stationnum, 'P', rownum, 'CV', 'AMP', a.name||' AMPB', null from gis_switch a, das_fakestationnum b where a.substation=(select name from gis_substation where ufid=(select teststationufid2 from das_fakestationnum)) and a.SWTYPE not like 'F%';insert into das_rtdb_fakestation select 'SWITCH', a.name, 'AMPC',   0,1,2, b.stationnum, 'P', rownum, 'CV', 'AMP', a.name||' AMPC', null from gis_switch a, das_fakestationnum b where a.substation=(select name from gis_substation where ufid=(select teststationufid2 from das_fakestationnum)) and a.SWTYPE not like 'F%';--/*insert into das_rtdb_fakestation select 'SWITCH', a.name, 'VOLTMAGA',   0,1,2, b.stationnum, 'P', rownum, 'CV', 'KV', a.name||' VOLTMAGA', null from gis_switch a, das_fakestationnum b where a.substation=(select name from gis_substation where ufid=(select teststationufid2 from das_fakestationnum)) and a.SWTYPE not like 'F%';insert into das_rtdb_fakestation select 'SWITCH', a.name, 'VOLTMAGB',   0,1,2, b.stationnum, 'P', rownum, 'CV', 'KV', a.name||' VOLTMAGB', null from gis_switch a, das_fakestationnum b where a.substation=(select name from gis_substation where ufid=(select teststationufid2 from das_fakestationnum)) and a.SWTYPE not like 'F%';insert into das_rtdb_fakestation select 'SWITCH', a.name, 'VOLTMAGC',   0,1,2, b.stationnum, 'P', rownum, 'CV', 'KV', a.name||' VOLTMAGC', null from gis_switch a, das_fakestationnum b where a.substation=(select name from gis_substation where ufid=(select teststationufid2 from das_fakestationnum)) and a.SWTYPE not like 'F%';--*/commit;-------------of Optional switchinsert into das_rtdb_fakestation select 'SWITCH', a.name, 'PA',   0,1,2, b.stationnum3, 'P', rownum, 'CV', 'KW', a.name||' PA', null from gis_switch a, das_fakestationnum b where a.name in(select equip_num from DAS_RTDB_FSTA_OPTIONAL_DEVICES) and a.SWTYPE not like 'F%';insert into das_rtdb_fakestation select 'SWITCH', a.name, 'PB',   0,1,2, b.stationnum3, 'P', rownum, 'CV', 'KW', a.name||' PB', null from gis_switch a, das_fakestationnum b where a.name in(select equip_num from DAS_RTDB_FSTA_OPTIONAL_DEVICES) and a.SWTYPE not like 'F%';insert into das_rtdb_fakestation select 'SWITCH', a.name, 'PC',   0,1,2, b.stationnum3, 'P', rownum, 'CV', 'KW', a.name||' PC', null from gis_switch a, das_fakestationnum b where a.name in(select equip_num from DAS_RTDB_FSTA_OPTIONAL_DEVICES) and a.SWTYPE not like 'F%';insert into das_rtdb_fakestation select 'SWITCH', a.name, 'QA',   0,1,2, b.stationnum3, 'P', rownum, 'CV', 'KVAR', a.name||' QA', null from gis_switch a, das_fakestationnum b where a.name in(select equip_num from DAS_RTDB_FSTA_OPTIONAL_DEVICES) and a.SWTYPE not like 'F%';insert into das_rtdb_fakestation select 'SWITCH', a.name, 'QB',   0,1,2, b.stationnum3, 'P', rownum, 'CV', 'KVAR', a.name||' QB', null from gis_switch a, das_fakestationnum b where a.name in(select equip_num from DAS_RTDB_FSTA_OPTIONAL_DEVICES) and a.SWTYPE not like 'F%';insert into das_rtdb_fakestation select 'SWITCH', a.name, 'QC',   0,1,2, b.stationnum3, 'P', rownum, 'CV', 'KVAR', a.name||' QC', null from gis_switch a, das_fakestationnum b where a.name in(select equip_num from DAS_RTDB_FSTA_OPTIONAL_DEVICES) and a.SWTYPE not like 'F%';insert into das_rtdb_fakestation select 'SWITCH', a.name, 'AMPA',   0,1,2, b.stationnum3, 'P', rownum, 'CV', 'AMP', a.name||' AMPA', null from gis_switch a, das_fakestationnum b where a.name in(select equip_num from DAS_RTDB_FSTA_OPTIONAL_DEVICES) and a.SWTYPE not like 'F%';insert into das_rtdb_fakestation select 'SWITCH', a.name, 'AMPB',   0,1,2, b.stationnum3, 'P', rownum, 'CV', 'AMP', a.name||' AMPB', null from gis_switch a, das_fakestationnum b where a.name in(select equip_num from DAS_RTDB_FSTA_OPTIONAL_DEVICES) and a.SWTYPE not like 'F%';insert into das_rtdb_fakestation select 'SWITCH', a.name, 'AMPC',   0,1,2, b.stationnum3, 'P', rownum, 'CV', 'AMP', a.name||' AMPC', null from gis_switch a, das_fakestationnum b where a.name in(select equip_num from DAS_RTDB_FSTA_OPTIONAL_DEVICES) and a.SWTYPE not like 'F%';--/*insert into das_rtdb_fakestation select 'SWITCH', a.name, 'VOLTMAGA',   0,1,2, b.stationnum3, 'P', rownum, 'CV', 'KV', a.name||' VOLTMAGA', null from gis_switch a, das_fakestationnum b where a.name in(select equip_num from DAS_RTDB_FSTA_OPTIONAL_DEVICES) and a.SWTYPE not like 'F%';insert into das_rtdb_fakestation select 'SWITCH', a.name, 'VOLTMAGB',   0,1,2, b.stationnum3, 'P', rownum, 'CV', 'KV', a.name||' VOLTMAGB', null from gis_switch a, das_fakestationnum b where a.name in(select equip_num from DAS_RTDB_FSTA_OPTIONAL_DEVICES) and a.SWTYPE not like 'F%';insert into das_rtdb_fakestation select 'SWITCH', a.name, 'VOLTMAGC',   0,1,2, b.stationnum3, 'P', rownum, 'CV', 'KV', a.name||' VOLTMAGC', null from gis_switch a, das_fakestationnum b where a.name in(select equip_num from DAS_RTDB_FSTA_OPTIONAL_DEVICES) and a.SWTYPE not like 'F%';--*/commit;--#####################################################Of Regulator ####################################################################################--insert into DAS_RTDB values ('TRANSFORMER','10310270','TAP',0,1,2,2,'P',1,'CV','TAP','TRANSFORMER 10310270 TAP',null);--######################################################################################################################################################insert into das_rtdb_fakestation select 'TRANSFORMER', a.name, 'TAP',   0,1,2, b.stationnum, 'P', rownum, 'CV', 'TAP', 'TRANSFORMER '||a.name||' TAP', null from gis_maintransformer a, das_fakestationnum b;insert into das_rtdb_fakestation select 'TRANSFORMER', a.name, 'VOLTMAGA',   0,1,2, b.stationnum, 'P', rownum, 'CV', 'VOLTMAGA', 'TRANSFORMER '||a.name||' VOLTMAGA', null from gis_maintransformer a, das_fakestationnum b;insert into das_rtdb_fakestation select 'TRANSFORMER', a.name, 'VOLTMAGB',   0,1,2, b.stationnum, 'P', rownum, 'CV', 'VOLTMAGB', 'TRANSFORMER '||a.name||' VOLTMAGB', null from gis_maintransformer a, das_fakestationnum b;insert into das_rtdb_fakestation select 'TRANSFORMER', a.name, 'VOLTMAGC',   0,1,2, b.stationnum, 'P', rownum, 'CV', 'VOLTMAGC', 'TRANSFORMER '||a.name||' VOLTMAGC', null from gis_maintransformer a, das_fakestationnum b;insert into das_rtdb_fakestation select 'TRANSFORMER', a.name, 'TOVOLTMAGA',   0,1,2, b.stationnum, 'P', rownum, 'CV', 'TOVOLTMAGA', 'TRANSFORMER '||a.name||' TOVOLTMAGA', null from gis_maintransformer a, das_fakestationnum b;insert into das_rtdb_fakestation select 'TRANSFORMER', a.name, 'TOVOLTMAGB',   0,1,2, b.stationnum, 'P', rownum, 'CV', 'TOVOLTMAGB', 'TRANSFORMER '||a.name||' TOVOLTMAGB', null from gis_maintransformer a, das_fakestationnum b;insert into das_rtdb_fakestation select 'TRANSFORMER', a.name, 'TOVOLTMAGC',   0,1,2, b.stationnum, 'P', rownum, 'CV', 'TOVOLTMAGC', 'TRANSFORMER '||a.name||' TOVOLTMAGC', null from gis_maintransformer a, das_fakestationnum b;update das_rtdb_fakestation set point=rownum where colname='TAP' and tablename='TRANSFORMER';update das_rtdb_fakestation set point=rownum where colname='VOLTMAGA' and tablename='TRANSFORMER';update das_rtdb_fakestation set point=rownum where colname='VOLTMAGB' and tablename='TRANSFORMER';update das_rtdb_fakestation set point=rownum where colname='VOLTMAGC' and tablename='TRANSFORMER';update das_rtdb_fakestation set point=rownum where colname='TOVOLTMAGA' and tablename='TRANSFORMER';update das_rtdb_fakestation set point=rownum where colname='TOVOLTMAGB' and tablename='TRANSFORMER';update das_rtdb_fakestation set point=rownum where colname='TOVOLTMAGC' and tablename='TRANSFORMER';--######################################################################################################################################################--######################################################################################################################################################--######################################################################################################################################################--###########################################################################--################################ReOrder Rownum for redundancy #############update das_rtdb_fakestation set point=rownum where colname='PA' and tablename='SWITCH' and station=(select stationnum from das_fakestationnum);update das_rtdb_fakestation set point=rownum where colname='PB' and tablename='SWITCH' and station=(select stationnum from das_fakestationnum);update das_rtdb_fakestation set point=rownum where colname='PC' and tablename='SWITCH' and station=(select stationnum from das_fakestationnum);update das_rtdb_fakestation set point=rownum where colname='QA' and tablename='SWITCH' and station=(select stationnum from das_fakestationnum);update das_rtdb_fakestation set point=rownum where colname='QB' and tablename='SWITCH' and station=(select stationnum from das_fakestationnum);update das_rtdb_fakestation set point=rownum where colname='QC' and tablename='SWITCH' and station=(select stationnum from das_fakestationnum);update das_rtdb_fakestation set point=rownum where colname='PC' and tablename='SWITCH' and station=(select stationnum from das_fakestationnum);update das_rtdb_fakestation set point=rownum where colname='AMPA' and tablename='SWITCH' and station=(select stationnum from das_fakestationnum);update das_rtdb_fakestation set point=rownum where colname='AMPB' and tablename='SWITCH' and station=(select stationnum from das_fakestationnum);update das_rtdb_fakestation set point=rownum where colname='AMPC' and tablename='SWITCH' and station=(select stationnum from das_fakestationnum);update das_rtdb_fakestation set point=rownum where colname='VOLTMAGA' and tablename='SWITCH' and station=(select stationnum from das_fakestationnum);update das_rtdb_fakestation set point=rownum where colname='VOLTMAGB' and tablename='SWITCH' and station=(select stationnum from das_fakestationnum);update das_rtdb_fakestation set point=rownum where colname='VOLTMAGC' and tablename='SWITCH' and station=(select stationnum from das_fakestationnum);--#####ReOrder Rownum for redundancy_optional#############update das_rtdb_fakestation set point=rownum where colname='PA' and tablename='SWITCH' and station=(select stationnum3 from das_fakestationnum);update das_rtdb_fakestation set point=rownum where colname='PB' and tablename='SWITCH' and station=(select stationnum3 from das_fakestationnum);update das_rtdb_fakestation set point=rownum where colname='PC' and tablename='SWITCH' and station=(select stationnum3 from das_fakestationnum);update das_rtdb_fakestation set point=rownum where colname='QA' and tablename='SWITCH' and station=(select stationnum3 from das_fakestationnum);update das_rtdb_fakestation set point=rownum where colname='QB' and tablename='SWITCH' and station=(select stationnum3 from das_fakestationnum);update das_rtdb_fakestation set point=rownum where colname='QC' and tablename='SWITCH' and station=(select stationnum3 from das_fakestationnum);update das_rtdb_fakestation set point=rownum where colname='PC' and tablename='SWITCH' and station=(select stationnum3 from das_fakestationnum);update das_rtdb_fakestation set point=rownum where colname='AMPA' and tablename='SWITCH' and station=(select stationnum3 from das_fakestationnum);update das_rtdb_fakestation set point=rownum where colname='AMPB' and tablename='SWITCH' and station=(select stationnum3 from das_fakestationnum);update das_rtdb_fakestation set point=rownum where colname='AMPC' and tablename='SWITCH' and station=(select stationnum3 from das_fakestationnum);update das_rtdb_fakestation set point=rownum where colname='VOLTMAGA' and tablename='SWITCH' and station=(select stationnum3 from das_fakestationnum);update das_rtdb_fakestation set point=rownum where colname='VOLTMAGB' and tablename='SWITCH' and station=(select stationnum3 from das_fakestationnum);update das_rtdb_fakestation set point=rownum where colname='VOLTMAGC' and tablename='SWITCH' and station=(select stationnum3 from das_fakestationnum);commit;--##		Define the point count per switch: 10 or 20update das_rtdb_fakestation set point = (point-1)*20 + 1 where colname='PA';--###########################################################################--################################Comb the point ############################update das_rtdb_fakestation a set point = (select point+1 from das_rtdb_fakestation where a.tablename||'x'||a.equip_num||'x'||'PB'=tablename||'x'||equip_num||'x'||colname)  where tablename in ('SWITCH') and colname='PB' and equip_num in (select equip_num from das_rtdb_fakestation where tablename='SWITCH' and colname='PB');update das_rtdb_fakestation a set point = (select point+2 from das_rtdb_fakestation where a.tablename||'x'||a.equip_num||'x'||'PC'=tablename||'x'||equip_num||'x'||colname)  where tablename in ('SWITCH') and colname='PC' and equip_num in (select equip_num from das_rtdb_fakestation where tablename='SWITCH' and colname='PC');update das_rtdb_fakestation a set point = (select point+3 from das_rtdb_fakestation where a.tablename||'x'||a.equip_num||'x'||'QA'=tablename||'x'||equip_num||'x'||colname)  where tablename in ('SWITCH') and colname='QA' and equip_num in (select equip_num from das_rtdb_fakestation where tablename='SWITCH' and colname='QA');update das_rtdb_fakestation a set point = (select point+4 from das_rtdb_fakestation where a.tablename||'x'||a.equip_num||'x'||'QB'=tablename||'x'||equip_num||'x'||colname)  where tablename in ('SWITCH') and colname='QB' and equip_num in (select equip_num from das_rtdb_fakestation where tablename='SWITCH' and colname='QB');update das_rtdb_fakestation a set point = (select point+5 from das_rtdb_fakestation where a.tablename||'x'||a.equip_num||'x'||'QC'=tablename||'x'||equip_num||'x'||colname)  where tablename in ('SWITCH') and colname='QC' and equip_num in (select equip_num from das_rtdb_fakestation where tablename='SWITCH' and colname='QC');update das_rtdb_fakestation a set point = (select point+6 from das_rtdb_fakestation where a.tablename||'x'||a.equip_num||'x'||'AMPA'=tablename||'x'||equip_num||'x'||colname)  where tablename in ('SWITCH') and colname='AMPA' and equip_num in (select equip_num from das_rtdb_fakestation where tablename='SWITCH' and colname='AMPA');update das_rtdb_fakestation a set point = (select point+7 from das_rtdb_fakestation where a.tablename||'x'||a.equip_num||'x'||'AMPB'=tablename||'x'||equip_num||'x'||colname)  where tablename in ('SWITCH') and colname='AMPB' and equip_num in (select equip_num from das_rtdb_fakestation where tablename='SWITCH' and colname='AMPB');update das_rtdb_fakestation a set point = (select point+8 from das_rtdb_fakestation where a.tablename||'x'||a.equip_num||'x'||'AMPC'=tablename||'x'||equip_num||'x'||colname)  where tablename in ('SWITCH') and colname='AMPC' and equip_num in (select equip_num from das_rtdb_fakestation where tablename='SWITCH' and colname='AMPC');--/*update das_rtdb_fakestation a set point = (select point+9 from das_rtdb_fakestation where a.tablename||'x'||a.equip_num||'x'||'PA'=tablename||'x'||equip_num||'x'||colname)  where tablename in ('SWITCH') and colname='VOLTMAGA' and equip_num in (select equip_num from das_rtdb_fakestation where tablename='SWITCH' and colname='PA');update das_rtdb_fakestation a set point = (select point+10 from das_rtdb_fakestation where a.tablename||'x'||a.equip_num||'x'||'PA'=tablename||'x'||equip_num||'x'||colname)  where tablename in ('SWITCH') and colname='VOLTMAGB' and equip_num in (select equip_num from das_rtdb_fakestation where tablename='SWITCH' and colname='PA');update das_rtdb_fakestation a set point = (select point+11 from das_rtdb_fakestation where a.tablename||'x'||a.equip_num||'x'||'PA'=tablename||'x'||equip_num||'x'||colname)  where tablename in ('SWITCH') and colname='VOLTMAGC' and equip_num in (select equip_num from das_rtdb_fakestation where tablename='SWITCH' and colname='PA');--*/update das_rtdb_fakestation a set point = (point+(select max(point) from das_rtdb_fakestation where tablename='SWITCH' and attribute='CV'))  where tablename in ('TRANSFORMER') and colname='TAP' and equip_num in (select equip_num from das_rtdb_fakestation where tablename='TRANSFORMER' and colname='TAP');update das_rtdb_fakestation a set point = (point+(select max(point) from das_rtdb_fakestation where tablename='SWITCH' and attribute='CV'))  where tablename in ('TRANSFORMER') and colname='VOLTMAGA' and equip_num in (select equip_num from das_rtdb_fakestation where tablename='TRANSFORMER' and colname='VOLTMAGA');update das_rtdb_fakestation a set point = (point+(select max(point) from das_rtdb_fakestation where tablename='SWITCH' and attribute='CV'))  where tablename in ('TRANSFORMER') and colname='VOLTMAGB' and equip_num in (select equip_num from das_rtdb_fakestation where tablename='TRANSFORMER' and colname='VOLTMAGB');update das_rtdb_fakestation a set point = (point+(select max(point) from das_rtdb_fakestation where tablename='SWITCH' and attribute='CV'))  where tablename in ('TRANSFORMER') and colname='VOLTMAGC' and equip_num in (select equip_num from das_rtdb_fakestation where tablename='TRANSFORMER' and colname='VOLTMAGC');update das_rtdb_fakestation a set point = (point+(select max(point) from das_rtdb_fakestation where tablename='SWITCH' and attribute='CV'))  where tablename in ('TRANSFORMER') and colname='TOVOLTMAGA' and equip_num in (select equip_num from das_rtdb_fakestation where tablename='TRANSFORMER' and colname='TOVOLTMAGA');update das_rtdb_fakestation a set point = (point+(select max(point) from das_rtdb_fakestation where tablename='SWITCH' and attribute='CV'))  where tablename in ('TRANSFORMER') and colname='TOVOLTMAGB' and equip_num in (select equip_num from das_rtdb_fakestation where tablename='TRANSFORMER' and colname='TOVOLTMAGB');update das_rtdb_fakestation a set point = (point+(select max(point) from das_rtdb_fakestation where tablename='SWITCH' and attribute='CV'))  where tablename in ('TRANSFORMER') and colname='TOVOLTMAGC' and equip_num in (select equip_num from das_rtdb_fakestation where tablename='TRANSFORMER' and colname='TOVOLTMAGC');--######################################################################################################################################################--######################################################################################################################################################--######################################################################################################################################################commit;--###########################################################################--###########################################################################--###########################################################################--##################Create the Fake DAS_RTDBCONTROL table####################--###########################################################################--###########################################################################drop table das_rtdbcontrol_fakestation ;create table das_rtdbcontrol_fakestation as select * from das_rtdbcontrol where equip_num ='EMPTY_DAS_RTDBCONTROL';-- of breaker--insert into das_rtdbcontrol_fakestation select 'SWITCH', a.name, 'STASTATUS', 1, 'SW_CTRL', b.stationnum, rownum, 0,0, b.stationnum, 'R', 0, 0, a.name from gis_breaker a, das_fakestationnum b;insert into das_rtdbcontrol_fakestation select 'SWITCH', a.name, 'STASTATUS', 1, 'SW_CTRL', b.stationnum, rownum, 0,0, b.stationnum, 'R', 0, 0, a.name from breaker a, das_fakestationnum b;-- of switch--insert into das_rtdbcontrol_fakestation select 'SWITCH', a.name, 'STASTATUS', 1, 'SW_CTRL', b.stationnum, rownum, 0,0, b.stationnum, 'R', 0, 0, a.name from gis_switch a, das_fakestationnum b where a.substation=(select name from gis_substation where ufid=(select teststationufid1 from das_fakestationnum)) and a.SWTYPE not like 'F%';insert into das_rtdbcontrol_fakestation select 'SWITCH', a.name, 'STASTATUS', 1, 'SW_CTRL', b.stationnum, rownum, 0,0, b.stationnum, 'R', 0, 0, a.name from gis_switch a, das_fakestationnum b where a.substation=(select name from gis_substation where ufid=(select teststationufid2 from das_fakestationnum)) and a.SWTYPE not like 'F%';-- of Optional switch--insert into das_rtdbcontrol_fakestation select 'SWITCH', a.name, 'STASTATUS', 1, 'SW_CTRL', b.stationnum3, rownum, 0,0, b.stationnum3, 'R', 0, 0, a.name from gis_switch a, das_fakestationnum b where a.name in(select equip_num from DAS_RTDB_FSTA_OPTIONAL_DEVICES) and a.SWTYPE not like 'F%';-- of capacitor--insert into das_rtdbcontrol_fakestation select 'CAPACITOR', a.name, 'STASTATUS', 0, 'CAP_CTRL', b.stationnum, rownum, 0,0, b.stationnum, 'R', 0, 0, a.name from gis_capacitor a, das_fakestationnum b;-- of transformer flag--insert into das_rtdbcontrol_fakestation select 'TRANSFORMER', a.name, 'TAP', 1, 'TAP_CTRL', b.stationnum, rownum, 0,0, b.stationnum, 'R', 0, 0, a.name from gis_maintransformer a, das_fakestationnum b;--insert into das_rtdbcontrol_fakestation select 'TRANSFORMER', a.name, 'LOCREMFLAG', 1, 'LOCREMFLAG_CTRL', b.stationnum, rownum, 0,0, b.stationnum, 'R', 0, 0, a.name from gis_maintransformer a, das_fakestationnum b;insert into das_rtdbcontrol_fakestation select 'TRANSFORMER', a.name, 'LTCLOCK', 1, 'LTCLOCK_CTRL', b.stationnum, rownum, 0,0, b.stationnum, 'R', 0, 0, a.name from gis_maintransformer a, das_fakestationnum b;insert into das_rtdbcontrol_fakestation select 'TRANSFORMER', a.name, 'LOCLTCLOCK', 1, 'LOCLTCLOCK_CTRL', b.stationnum, rownum, 0,0, b.stationnum, 'R', 0, 0, a.name from gis_maintransformer a, das_fakestationnum b;insert into das_rtdbcontrol_fakestation select 'TRANSFORMER', a.name, 'VCTICK', 1, 'VCTICK_CTRL', b.stationnum, rownum, 0,0, b.stationnum, 'R', 0, 0, a.name from gis_maintransformer a, das_fakestationnum b;commit;--###########################################################################--##update gis_switch a set substation=(select substname from view_feeder_all b where a.FEEDER=b.name);--###########################################################################--######Update Status points based on das_rtdb_fakestation table#############update das_rtdbcontrol_fakestation a set ctrlrecord=(select point from das_rtdb_fakestation where a.equip_num=equip_num and a.tablename=tablename and a.colname=colname),                                   solicitpoint=(select point    from das_rtdb_fakestation where a.equip_num=equip_num and a.tablename=tablename and a.colname=colname),                                 solicitstation=(select station  from das_rtdb_fakestation where a.equip_num=equip_num and a.tablename=tablename and a.colname=colname),								 solicitcategory='R'--#                                solicitcategory=(select category from das_rtdb_fakestation where a.equip_num=equip_num and a.tablename=tablename and a.colname=colname)  where a.tablename||'x'||a.equip_num||'x'||a.colname in (select a.tablename||'x'||a.equip_num||'x'||a.colname from das_rtdb_fakestation where station=(select stationnum from das_fakestationnum));--############################################################################# --############################################################################# CL20160910 update das_rtdbcontrol_fakestation a set ctrlrecord=(select point from das_rtdb_fakestation where a.equip_num=equip_num and a.tablename=tablename and a.colname=colname),                                   solicitpoint=(select point    from das_rtdb_fakestation where a.equip_num=equip_num and a.tablename=tablename and a.colname=colname),                                 solicitstation=(select station  from das_rtdb_fakestation where a.equip_num=equip_num and a.tablename=tablename and a.colname=colname),								 solicitcategory='R' where a.tablename||'x'||a.equip_num||'x'||a.colname in (select a.tablename||'x'||a.equip_num||'x'||a.colname from das_rtdb_fakestation where station=(select stationnum3 from das_fakestationnum));update das_rtdbcontrol_fakestation a set descript=ctrltype||' '||equip_num, openrelay=(solicitpoint-1)*2+1, closerelay=(solicitpoint-1)*2+2;--Description unitized--update das_rtdbcontrol_fakestation set descript=ctrltype||' '||descript||' '||equip_num;commit;/*--###################################################################################################################################### --## Insert Fake DAS_RTDB Xref into formal DAS_RTDB Xref tables--delete das_rtdb a where tablename||'x'||equip_num||'x'||colname in (select tablename||'x'||equip_num||'x'||colname from das_rtdb_fakestation); --AUTO_FSTA process--delete das_rtdb where station=(select stationnum from das_rtdb_fakestation) and category='R';--insert into das_rtdb select * from das_rtdb_fakestation where enableflag=1;commit;--delete das_rtdbcontrol a where tablename||'x'||equip_num||'x'||colname in (select tablename||'x'||equip_num||'x'||colname from das_rtdbcontrol_fakestation); --insert into das_rtdbcontrol select * from das_rtdbcontrol_fakestation where enableflag=1;commit;*/--## CL20160910: The DAS_RTDB Xref should be updated/inserted prior to the following procedures (DAS_DEFAULT)--##############################################################################--##############################################################################--##############################################################################--### Insert records into DAS_DEFAULT to maintain Default values.--##############################################################################--##############################################################################--##############################################################################--## SYSTEM/*--##	For NEMO TX system, DPF will be set up to use Power/Energy in MVA, MW, MVar. (DAS_TRANSMISSION_NETWORK=1)update DAS_SYSTEM set BASEKVA=BASEKVA/1000 where BASEKVA>=1000;commit;*/delete das_default where tablename='SYSTEM' and colname in ('CBCRUNINTERVAL','VCRUNINTERVAL','CBCCTRL','VCMODE');insert into das_default values ('SYSTEM','SYSTEM','CBCRUNINTERVAL',15);insert into das_default values ('SYSTEM','SYSTEM', 'VCRUNINTERVAL',30);insert into das_default values ('SYSTEM','SYSTEM', 'CBCCTRL',0);insert into das_default values ('SYSTEM','SYSTEM',  'VCMODE',0);commit;--############################################################--# GIS_MAINTRANSFORMER.--# Transformer default tap position.delete das_default where tablename='TRANSFORMER' and colname in ('LOCLTCLOCK','LTCLOCK','VCLOCKFLAG','TAP','LOCREMFLAG');--insert into DAS_DEFAULT select 'TRANSFORMER',name,'TAP',3 from view_MXFMR insert into DAS_DEFAULT select 'TRANSFORMER',name,'TAP',NormTap from view_MXFMR       where name not in (select equip_num from das_default where tablename='TRANSFORMER' and colname='TAP');--update das_default set defaultvalue=-6 where tablename='TRANSFORMER' and colname='TAP' and equip_num in (select equip_num from das_rtdbcontrol where tablename ='TRANSFORMER');insert into das_default select 'TRANSFORMER',name,'VCLOCKFLAG', 1 from view_mxfmr;update das_default set defaultvalue=0 where tablename='TRANSFORMER' and colname='VCLOCKFLAG' and equip_num in (select unique(equip_num) from das_rtdbcontrol where tablename ='TRANSFORMER');insert into DAS_DEFAULT select 'TRANSFORMER',equip_num,'LOCREMFLAG',0 from das_rtdbcontrol where tablename='TRANSFORMER' and colname='TAP';insert into das_default select 'TRANSFORMER',name,'LOCLTCLOCK', 0 from view_mxfmr;insert into das_default select 'TRANSFORMER',name,   'LTCLOCK', 1 from view_mxfmr;commit;--############################################################--# GIS_CAPACITOR, CAPACITORdelete DAS_DEFAULT where tablename='CAPACITOR' and colname in ('STASTATUS','LOCREMFLAG');--# Set StaStatus of all GIS Capacitors to be 0 (open).insert into DAS_DEFAULT select 'CAPACITOR',name,'STASTATUS', 0 from GIS_CAPACITOR;--update das_default set defaultvalue=0 where tablename='CAPACITOR' and colname='LOCREMFLAG' and equip_num in (select unique(equip_num) from das_rtdbcontrol where tablename ='CAPACITOR');commit;--###################################################################################################################################### --## GIS_SWITCH, SWITCH, GIS_BREAKER, BREAKER--## Insert LOCREMFLAG into DAS_DEFAULTdelete DAS_DEFAULT where tablename='SWITCH' and colname in ('LOCREMFLAG');insert into DAS_DEFAULT select 'SWITCH',equip_num,'LOCREMFLAG',0 from das_rtdbcontrol where tablename='SWITCH' and colname='STASTATUS';--update das_default set defaultvalue=0 where tablename='SWITCH' and colname='LOCREMFLAG' and equip_num in (select unique(equip_num) from das_rtdbcontrol where tablename ='SWITCH');commit;--############################################################--# GIS_FEEDER & FEEDER--###########Of PEAKLOAD##################drop table FEEDER_PEAKLOAD;create table FEEDER_PEAKLOAD as select name,FEEDER, substname, brkname,AmpNlmt PeakLOAD from GIS_FEEDER where fdtype=0 ;insert into FEEDER_PEAKLOAD select name,FEEDER, substname, brkname,AmpNlmt PeakLOAD from FEEDER where fdtype=0 ;UPDATE FEEDER_PEAKLOAD SET PeakLOAD=0;COMMIT;drop table FEEDERCount;create table FEEDERCount as select substname, PeakLOAD capacity, PeakLOAD NumFD,PeakLOAD PEAKLOAD from FEEDER_PEAKLOAD where name='Empty';insert into FEEDERCount select substname,0,0,0 from FEEDER_PEAKLOAD  group by substname;--##	Option1/*update FEEDERCount a set capacity=(select max(capacity) from gis_maintransformer where substation=a.substname group by substation);update FEEDERCount a set capacity=(select max(capacity) from     maintransformer where substation=a.substname group by substation) where a.capacity < (select max(capacity) from maintransformer where substation=a.substname);*/--##	Option2update FEEDERCount a set capacity=0 where capacity is null;update FEEDERCount a set capacity=capacity+(select sum(capacity) from gis_maintransformer where substation=a.substname and feeder in (select name from view_feeder where fdtype=1) group by substation);update FEEDERCount a set capacity=0 where capacity is null;update FEEDERCount a set capacity=capacity+(select sum(capacity) from     maintransformer where substation=a.substname and feeder in (select name from view_feeder where fdtype=1) group by substation);update FEEDERCount a set NumFD=(select count(*) from FEEDER_PEAKLOAD where substname=a.substname group by substname);commit;UPDATE FEEDERCount a SET PEAKLOAD=(select round(((capacity*0.8)/NUMFD),0) from FEEDERCount where a.substname=substname);update FEEDER_PEAKLOAD a set PEAKLOAD=(select PEAKLOAD from FEEDERCount where a.substname=substname);/*	update FEEDER_PEAKLOAD set PEAKLOAD=2000*0.8 where PEAKLOAD is null;	update feeder_peakload set peakload=400 where name='SD-4-L_FDR';*/commit;/*--##	For NEMO TX system, DPF will be set up to use Power/Energy in MVA, MW, MVar. (DAS_TRANSMISSION_NETWORK=1)update FEEDER_PEAKLOAD a set PEAKLOAD=round(PEAKLOAD/1000,2);COMMIT;*/--# Feeder defaults--delete DAS_DEFAULT where tablename='FEEDER';--delete das_default where tablename='FEEDER' and colname in ('PEAKLOAD','CBCLOCKFLAG','VCLOCKFLAG','VCLOLMT','VCHILMT','VCDEADBAND','FDIRLOCKFLAG','FDIRACTFLAG','RECLOSERDELAY','VCPTRATIO');delete das_default where tablename='FEEDER' and colname in ('CBCLOCKFLAG','VCLOCKFLAG','VCLOLMT','VCHILMT','VCDEADBAND','VCPTRATIO','FDIRLOCKFLAG','FDIRACTFLAG','RECLOSERDELAY');--## Feeder Peakloaddelete das_default where tablename='FEEDER' and colname='PEAKLOAD' and equip_num in (select name from Feeder_PeakLoad);insert into DAS_DEFAULT select 'FEEDER',name,'PEAKLOAD',PEAKLOAD from Feeder_PeakLoad ;commit;--##############--## For FDIR/*insert into DAS_DEFAULT select 'FEEDER',name,'FDIRLOCKFLAG',1 from view_FEEDER where fdtype=1;insert into DAS_DEFAULT select 'FEEDER',name,'FDIRLOCKFLAG',0 from view_FEEDER where fdtype=0;*/insert into DAS_DEFAULT select 'FEEDER',name,'FDIRLOCKFLAG',1 from view_FEEDER;--update DAS_DEFAULT set defaultvalue=0 where tablename='FEEDER' and colname='FDIRLOCKFLAG' and equip_num in ('','');insert into DAS_DEFAULT select 'FEEDER',name,'RECLOSERDELAY',70 from view_FEEDER       where name not in (select equip_num from das_default where tablename='FEEDER' and colname='RECLOSERDELAY');commit;--##############--## For IVVC/VCinsert into DAS_DEFAULT select 'FEEDER',name,'VCLOCKFLAG',1 from view_FEEDER;--update DAS_DEFAULT set defaultvalue=0 where tablename='FEEDER' and colname='VCLOCKFLAG' and equip_num in ('','');insert into das_default select 'FEEDER',name,'VCLOLMT',  120     from view_FEEDER where fdtype=0;insert into das_default select 'FEEDER',name,'VCHILMT',  128     from view_FEEDER where fdtype=0;insert into das_default select 'FEEDER',name,'VCDEADBAND', 2     from view_FEEDER where fdtype=0;insert into das_default select 'FEEDER',name,'VCPTRATIO', 28.868 from view_FEEDER where fdtype=0;update das_default set VCPTRATIO=120/23*1.732, VCLOLMT=120, VCHILMT=128, VCBANDWITH=2 where tablename='FEEDER' and equip_num in (select name from view_feeder where fdtype=0);insert into das_default select 'FEEDER',name,'VCLOLMT',  120     from view_FEEDER where fdtype=1;insert into das_default select 'FEEDER',name,'VCHILMT',  128     from view_FEEDER where fdtype=1;insert into das_default select 'FEEDER',name,'VCDEADBAND', 2     from view_FEEDER where fdtype=1;insert into das_default select 'FEEDER',name,'VCPTRATIO',  3.012 from view_FEEDER where fdtype=1;update das_default set VCPTRATIO=120/69*1.732, VCLOLMT=120, VCHILMT=128, VCBANDWITH=2 where tablename='FEEDER' and equip_num in (select name from view_feeder where fdtype=1);commit;--##############--## For IVVC/CBCinsert into DAS_DEFAULT select 'FEEDER',name,'CBCLOCKFLAG',1 from view_FEEDER;--update DAS_DEFAULT set defaultvalue=0 where tablename='FEEDER' and colname='CBCLOCKFLAG' and equip_num in ('','');commit;exit;